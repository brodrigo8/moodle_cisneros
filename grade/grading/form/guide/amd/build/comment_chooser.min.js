define(["jquery","core/templates","core/notification","core/yui"],function(a,b,c){return{initialise:function(d,e,f,g){function h(){var d=a.parseJSON(a("#frequently-used-comment-options").val()),e={comments:d};b.render("gradingform_guide/comment_chooser",e).done(function(a){i(a,d)}).fail(c.exception)}function i(b,c){var e="comment-chooser-cancel",h='<button id="'+e+'">'+g+"</button>",i=new M.core.dialogue({modal:!0,headerContent:d,bodyContent:b,footerContent:h,focusAfterHide:"#"+f,id:"comments-chooser-dialog"});i.show(),a(document).off("click","#"+e).on("click","#"+e,function(){"undefined"!=typeof i&&i.hide()}),a.each(c,function(b,c){var d="#comment-option-"+c.id;a(document).off("click",d).on("click",d,function(){var b=a("#"+f),d=b.val();""!==a.trim(d)&&(d+="\n"),d+=c.description,b.val(d),"undefined"!=typeof i&&i.hide()}),a(document).off("keypress",d).on("keypress",d,function(){var b=event.which||event.keyCode;(13==b||32==b)&&a(d).click()})})}a("#"+e).click(function(a){a.preventDefault(),h()})}}});