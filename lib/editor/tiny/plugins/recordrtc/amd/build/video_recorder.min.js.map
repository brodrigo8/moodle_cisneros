{"version":3,"file":"video_recorder.min.js","sources":["../src/video_recorder.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tiny Record RTC - Video recorder configuration.\n *\n * @module      tiny_recordrtc/video\n * @copyright   2022 Stevani Andolo <stevani@hotmail.com.au>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport BaseClass from './base_recorder';\nimport Modal from 'tiny_recordrtc/modal';\nimport ModalRegistry from 'core/modal_registry';\nimport {component} from 'tiny_recordrtc/common';\n\nexport default class Video extends BaseClass {\n    configurePlayer() {\n        return this.modalRoot.querySelector('video');\n    }\n\n    getSupportedTypes() {\n        return [\n            'video/webm;codecs=vp9,opus',\n            'video/webm;codecs=h264,opus',\n            'video/webm;codecs=vp8,opus',\n        ];\n\n    }\n\n    getParsedRecordingOptions() {\n        return {\n            audioBitsPerSecond: parseInt(this.config.audiobitrate),\n            videoBitsPerSecond: parseInt(this.config.videobitrate)\n        };\n    }\n\n    getMediaConstraints() {\n        return {\n            audio: true,\n            video: {\n                width: {\n                    ideal: 640,\n                },\n                height: {\n                    ideal: 480,\n                },\n            },\n        };\n    }\n\n    playOnCapture() {\n        // Play the recording back on capture.\n        return true;\n    }\n\n    getRecordingType() {\n        return 'video';\n    }\n\n    getTimeLimit() {\n        return this.config.videotimelimit;\n    }\n\n    getEmbedTemplateName() {\n        return 'tiny_recordrtc/embed_video';\n    }\n\n    getFileName(prefix) {\n        return `${prefix}-video.webm`;\n    }\n\n    static getModalClass() {\n        const modalType = `${component}/video_recorder`;\n        const registration = ModalRegistry.get(modalType);\n        if (registration) {\n            return registration.module;\n        }\n\n        const VideoModal = class extends Modal {\n            static TYPE = modalType;\n            static TEMPLATE = `${component}/video_recorder`;\n        };\n\n        ModalRegistry.register(VideoModal.TYPE, VideoModal, VideoModal.TEMPLATE);\n        return VideoModal;\n    }\n}\n"],"names":["_interopRequireDefault","obj","__esModule","default","_defineProperty","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","_createClass","protoProps","staticProps","prototype","arg","input","hint","_typeof","prim","Symbol","toPrimitive","undefined","res","call","String","Number","_toPrimitive","_inherits","subClass","superClass","create","constructor","_setPrototypeOf","o","p","setPrototypeOf","bind","__proto__","_createSuper","Derived","hasNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","valueOf","e","_isNativeReflectConstruct","result","Super","_getPrototypeOf","NewTarget","this","arguments","apply","_possibleConstructorReturn","self","ReferenceError","_assertThisInitialized","getPrototypeOf","_base_recorder","_modal","_modal_registry","Video","_BaseClass","_super","modalRoot","querySelector","audioBitsPerSecond","parseInt","config","audiobitrate","videoBitsPerSecond","videobitrate","audio","video","width","ideal","height","videotimelimit","prefix","concat","_class","modalType","component","registration","ModalRegistry","get","module","VideoModal","_Modal","_super2","Modal","register","TYPE","TEMPLATE","BaseClass","_exports"],"mappings":"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"}