{"version":3,"file":"options.min.js","sources":["../src/options.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Options helper for the Moodle Tiny Autosave plugin.\n *\n * @module      tiny_autosave/plugin\n * @copyright   2022 Andrew Lyons <andrew@nicols.co.uk>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {pluginName} from './common';\nimport {\n    getContextId,\n    getDraftItemId,\n    getPluginOptionName,\n} from 'editor_tiny/options';\nimport {ensureEditorIsValid} from 'editor_tiny/utils';\n\nconst initialisedOptionName = getPluginOptionName(pluginName, 'initialised');\nconst pageHashName = getPluginOptionName(pluginName, 'pagehash');\nconst pageInstanceName = getPluginOptionName(pluginName, 'pageinstance');\nconst backoffTime = getPluginOptionName(pluginName, 'backoffTime');\nconst autosaveHasReset = getPluginOptionName(pluginName, 'autosaveHasReset');\n\nexport const register = (editor) => {\n    const registerOption = editor.options.register;\n    registerOption(initialisedOptionName, {\n        processor: 'boolean',\n        \"default\": false,\n    });\n\n    registerOption(pageHashName, {\n        processor: 'string',\n        \"default\": '',\n    });\n\n    registerOption(pageInstanceName, {\n        processor: 'string',\n        \"default\": '',\n    });\n    registerOption(pageInstanceName, {\n        processor: 'string',\n        \"default\": '',\n    });\n    registerOption(backoffTime, {\n        processor: 'number',\n        \"default\": 500,\n    });\n    registerOption(autosaveHasReset, {\n        processor: 'boolean',\n        \"default\": false,\n    });\n};\n\nexport const isInitialised = (editor) => {\n    if (!ensureEditorIsValid(editor)) {\n        return false;\n    }\n\n    return editor.options.get(initialisedOptionName);\n};\nexport const markInitialised = (editor) => editor.options.set(initialisedOptionName, true);\nexport const getPageHash = (editor) => editor.options.get(pageHashName);\nexport const getPageInstance = (editor) => editor.options.get(pageInstanceName);\nexport const getBackoffTime = (editor) => editor.options.get(backoffTime);\nexport const setAutosaveHasReset = (editor) => editor.options.set(autosaveHasReset, true);\nexport const hasAutosaveHasReset = (editor) => editor.options.get(autosaveHasReset);\n\nexport {\n    getContextId,\n    getDraftItemId,\n};\n"],"names":["initialisedOptionName","getPluginOptionName","pluginName","pageHashName","pageInstanceName","backoffTime","autosaveHasReset","_exports","register","editor","registerOption","options","processor","default","isInitialised","ensureEditorIsValid","get","markInitialised","set","getPageHash","getPageInstance","getBackoffTime","setAutosaveHasReset","hasAutosaveHasReset"],"mappings":";;;;;;;;AA+BA,IAAMA,uBAAwB,EAAAC,SAAAA,qBAAoBC,QAAUA,WAAE,eACxDC,cAAe,EAAAF,SAAAA,qBAAoBC,QAAUA,WAAE,YAC/CE,kBAAmB,EAAAH,SAAAA,qBAAoBC,QAAUA,WAAE,gBACnDG,aAAc,EAAAJ,SAAAA,qBAAoBC,QAAUA,WAAE,eAC9CI,kBAAmB,EAAAL,SAAAA,qBAAoBC,QAAUA,WAAE,oBA8BvDK,SAAAC,SA5BsB,SAACC,QACrB,IAAMC,eAAiBD,OAAOE,QAAQH,SACtCE,eAAeV,sBAAuB,CAClCY,UAAW,UACXC,SAAW,IAGfH,eAAeP,aAAc,CACzBS,UAAW,SACXC,QAAW,KAGfH,eAAeN,iBAAkB,CAC7BQ,UAAW,SACXC,QAAW,KAEfH,eAAeN,iBAAkB,CAC7BQ,UAAW,SACXC,QAAW,KAEfH,eAAeL,YAAa,CACxBO,UAAW,SACXC,QAAW,MAEfH,eAAeJ,iBAAkB,CAC7BM,UAAW,UACXC,SAAW,KAUjBN,SAAAO,cAN2B,SAACL,QAC1B,SAAK,EAAAM,OAAAA,qBAAoBN,SAIlBA,OAAOE,QAAQK,IAAIhB,wBAE6DO,SAAAU,gBAA5D,SAACR,QAAM,OAAKA,OAAOE,QAAQO,IAAIlB,uBAAuB,EAAK,EAClBO,SAAAY,YAA7C,SAACV,QAAM,OAAKA,OAAOE,QAAQK,IAAIb,aAAa,EACSI,SAAAa,gBAAjD,SAACX,QAAM,OAAKA,OAAOE,QAAQK,IAAIZ,iBAAiB,EACLG,SAAAc,eAA5C,SAACZ,QAAM,OAAKA,OAAOE,QAAQK,IAAIX,YAAY,EACiBE,SAAAe,oBAAvD,SAACb,QAAM,OAAKA,OAAOE,QAAQO,IAAIZ,kBAAkB,EAAK,EACLC,SAAAgB,oBAAjD,SAACd,QAAM,OAAKA,OAAOE,QAAQK,IAAIV,iBAAiB,CAAC"}