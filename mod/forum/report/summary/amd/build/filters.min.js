define ("forumreport_summary/filters",["exports","jquery","core/popper","core/custom_interaction_events","forumreport_summary/selectors","core/yui","core/ajax"],function(a,b,c,d,e,f,g){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=h(b);c=h(c);d=h(d);e=h(e);f=h(f);g=h(g);function h(a){return a&&a.__esModule?a:{default:a}}var i=function(a){var h=(0,b.default)(a);(0,b.default)(document).ready(function(){(0,b.default)(".loading-icon").hide();(0,b.default)("#summaryreport").removeClass("hidden")});var i=function(a){var c=(0,b.default)("#filtersform").attr("action");if(a){a.preventDefault();var d=a.target.search.substr(1);c+="&"+d}(0,b.default)("#filtersform").attr("action",c);(0,b.default)("#filtersform").submit()};(0,b.default)(".resettable").on("click","a",function(a){i(a)});(0,b.default)("thead").on("click","a",function(a){i(a)});(0,b.default)(".pagination").on("click","a",function(a){i(a)});var j=function(a){(0,b.default)(a).addClass("hidden");i(!1)},k=function(){var a=document.querySelector(e.default.filters.date.popover),b=document.querySelector(e.default.filters.date.calendar);new c.default(a,b,{placement:"bottom"})},l=function(a){if(document.querySelector("[data-openfilter=\"true\"]")){return!1}a.target.setAttribute("data-openfilter","true");return!0};h.on(d.default.events.activate,e.default.filters.group.selectall,function(){var b=a.querySelectorAll(e.default.filters.group.checkbox+":not(:checked)");b.forEach(function(a){a.checked=!0})});h.on(d.default.events.activate,e.default.filters.group.clear,function(){var b=a.querySelectorAll(e.default.filters.group.checkbox+":checked");b.forEach(function(a){a.checked=!1})});h.on(d.default.events.activate,e.default.filters.group.trigger,function(b){if(!l(b)){return!1}var d=a.querySelector(e.default.filters.group.trigger),f=a.querySelector(e.default.filters.group.popover);new c.default(d,f,{placement:"bottom"});f.classList.remove("hidden");d.classList.add("btn-outline-primary");d.classList.remove("btn-primary");d.setAttribute("aria-expanded",!0);return!0});h.on(d.default.events.activate,e.default.filters.group.save,function(){j("#filter-groups-popover")});h.on(d.default.events.activate,e.default.filters.date.trigger,function(b){if(!l(b)){return!1}var d=a.querySelector(e.default.filters.date.trigger),f=a.querySelector(e.default.filters.date.popover);new c.default(d,f,{placement:"bottom"});f.classList.remove("hidden");f.querySelector("[name=\"filterdatefrompopover[enabled]\"]").focus();d.classList.add("btn-outline-primary");d.classList.remove("btn-primary");d.setAttribute("aria-expanded",!0);return!0});h.on(d.default.events.activate,e.default.filters.date.save,function(){var b=document.forms.filtersform,c=a.querySelector(e.default.filters.date.popover),d={day:c.querySelector("[name=\"filterdatefrompopover[day]\"]").value,month:c.querySelector("[name=\"filterdatefrompopover[month]\"]").value,year:c.querySelector("[name=\"filterdatefrompopover[year]\"]").value,enabled:c.querySelector("[name=\"filterdatefrompopover[enabled]\"]").checked?1:0},h={day:c.querySelector("[name=\"filterdatetopopover[day]\"]").value,month:c.querySelector("[name=\"filterdatetopopover[month]\"]").value,year:c.querySelector("[name=\"filterdatetopopover[year]\"]").value,enabled:c.querySelector("[name=\"filterdatetopopover[enabled]\"]").checked?1:0};f.default.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()});if(!d.enabled&&!h.enabled){b.elements["datefrom[timestamp]"].value=0;b.elements["datefrom[enabled]"].value=d.enabled;b.elements["dateto[timestamp]"].value=0;b.elements["dateto[enabled]"].value=h.enabled;j("#filter-dates-popover")}else{g.default.call([{methodname:"forumreport_summary_get_timestamps",args:{datefrom:d,dateto:h}}])[0].done(function(a){if(0<a.warnings.length){var c=document.getElementById("dates-filter-warning");c.textContent=a.warnings[0].message;c.classList.remove("hidden");c.classList.add("d-block")}else{b.elements["datefrom[timestamp]"].value=a.timestampfrom;b.elements["datefrom[enabled]"].value=d.enabled;b.elements["dateto[timestamp]"].value=a.timestampto;b.elements["dateto[enabled]"].value=h.enabled;j("#filter-dates-popover")}})}});h.on("click","#id_filterdatefrompopover_calendar",function(){k()});h.on("click","#id_filterdatetopopover_calendar",function(){k()})};a.init=i});
//# sourceMappingURL=filters.min.js.map
