{"version":3,"file":"grader.min.js","sources":["../../src/grades/grader.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This module will tie together all of the different calls the gradable module will make.\n *\n * @module     mod_forum/grades/grader\n * @copyright  2019 Andrew Nicols <andrew@nicols.co.uk>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport * as Selectors from './grader/selectors';\nimport Repository from 'mod_forum/repository';\nimport Templates from 'core/templates';\nimport * as Grader from '../local/grades/grader';\nimport Notification from 'core/notification';\nimport CourseRepository from 'core_course/repository';\nimport {relativeUrl} from 'core/url';\n\nconst templateNames = {\n    contentRegion: 'mod_forum/grades/grader/discussion/posts',\n};\n\n/**\n * Curried function with CMID set, this is then used in unified grader as a fetch a users content.\n *\n * @param {Number} cmid\n * @param {Bool} experimentalDisplayMode\n * @return {Function}\n */\nconst getContentForUserIdFunction = (cmid, experimentalDisplayMode) => (userid) => {\n    /**\n     * Given the parent function is called with the second param set execute the partially executed function.\n     *\n     * @param {Number} userid\n     */\n    return Repository.getDiscussionByUserID(userid, cmid)\n        .then(context => {\n            // Rebuild the returned data for the template.\n            context.discussions = context.discussions.map(discussionPostMapper);\n            context.experimentaldisplaymode = experimentalDisplayMode ? true : false;\n\n            return Templates.render(templateNames.contentRegion, context);\n        })\n        .catch(Notification.exception);\n};\n\n/**\n * Curried function with CMID set, this is then used in unified grader as a fetch users call.\n * The function curried fetches all users in a course for a given CMID.\n *\n * @param {Number} cmid\n * @param {Number} groupID\n * @param {Boolean} onlyActive Whether to fetch only the active enrolled users or all enrolled users in the course.\n * @return {Array} Array of users for a given context.\n */\nconst getUsersForCmidFunction = (cmid, groupID, onlyActive) => async() => {\n    const context = await CourseRepository.getUsersFromCourseModuleID(cmid, groupID, onlyActive);\n\n    return context.users;\n};\n\n\nconst findGradableNode = node => node.closest(Selectors.gradableItem);\n\n/**\n * For a discussion we need to manipulate it's posts to hide certain UI elements.\n *\n * @param {Object} discussion\n * @return {Array} name, id, posts\n */\nconst discussionPostMapper = (discussion) => {\n    // Map postid => post.\n    const parentMap = new Map();\n    discussion.posts.parentposts.forEach(post => parentMap.set(post.id, post));\n    const userPosts = discussion.posts.userposts.map(post => {\n        post.readonly = true;\n        post.hasreplies = false;\n        post.replies = [];\n\n        const parent = post.parentid ? parentMap.get(post.parentid) : null;\n        if (parent) {\n            parent.hasreplies = false;\n            parent.replies = [];\n            parent.readonly = true;\n            post.parentauthorname = parent.author.fullname;\n        }\n\n        return {\n            parent,\n            post\n        };\n    });\n\n    return {\n        ...discussion,\n        posts: userPosts,\n    };\n};\n\n/**\n * Launch the Grader.\n *\n * @param {HTMLElement} rootNode the root HTML element describing what is to be graded\n * @param {object} param\n * @param {bool} [param.focusOnClose=null]\n */\nconst launchWholeForumGrading = async(rootNode, {\n    focusOnClose = null,\n} = {}) => {\n    const data = rootNode.dataset;\n    const gradingPanelFunctions = await Grader.getGradingPanelFunctions(\n        'mod_forum',\n        data.contextid,\n        data.gradingComponent,\n        data.gradingComponentSubtype,\n        data.gradableItemtype\n    );\n\n    const groupID = data.group ? data.group : 0;\n    const onlyActive = data.gradeOnlyActiveUsers;\n\n    await Grader.launch(\n        getUsersForCmidFunction(data.cmid, groupID, onlyActive),\n        getContentForUserIdFunction(data.cmid, data.experimentalDisplayMode == \"1\"),\n        gradingPanelFunctions.getter,\n        gradingPanelFunctions.setter,\n        {\n            groupid: data.groupid,\n            initialUserId: data.initialuserid,\n            moduleName: data.name,\n            courseName: data.courseName,\n            courseUrl: relativeUrl('/course/view.php', {id: data.courseId}),\n            sendStudentNotifications: data.sendStudentNotifications,\n            focusOnClose,\n        }\n    );\n};\n\n/**\n * Launch the Grader.\n *\n * @param {HTMLElement} rootNode the root HTML element describing what is to be graded\n * @param {object} param\n * @param {bool} [param.focusOnClose=null]\n */\nconst launchViewGrading = async(rootNode, {\n    focusOnClose = null,\n} = {}) => {\n    const data = rootNode.dataset;\n    const gradingPanelFunctions = await Grader.getGradingPanelFunctions(\n        'mod_forum',\n        data.contextid,\n        data.gradingComponent,\n        data.gradingComponentSubtype,\n        data.gradableItemtype\n    );\n\n    await Grader.view(\n        gradingPanelFunctions.getter,\n        data.userid,\n        data.name,\n        {\n            focusOnClose,\n        }\n    );\n};\n\n/**\n * Register listeners to launch the grading panel.\n */\nexport const registerLaunchListeners = () => {\n    document.addEventListener('click', async(e) => {\n        if (e.target.matches(Selectors.launch)) {\n            const rootNode = findGradableNode(e.target);\n\n            if (!rootNode) {\n                throw Error('Unable to find a gradable item');\n            }\n\n            if (rootNode.matches(Selectors.gradableItems.wholeForum)) {\n                // Note: The preventDefault must be before any async function calls because the function becomes async\n                // at that point and the default action is implemented.\n                e.preventDefault();\n                try {\n                    await launchWholeForumGrading(rootNode, {\n                        focusOnClose: e.target,\n                    });\n                } catch (error) {\n                    Notification.exception(error);\n                }\n            } else {\n                throw Error('Unable to find a valid gradable item');\n            }\n        }\n        if (e.target.matches(Selectors.viewGrade)) {\n            e.preventDefault();\n            const rootNode = findGradableNode(e.target);\n\n            if (!rootNode) {\n                throw Error('Unable to find a gradable item');\n            }\n\n            if (rootNode.matches(Selectors.gradableItems.wholeForum)) {\n                // Note: The preventDefault must be before any async function calls because the function becomes async\n                // at that point and the default action is implemented.\n                e.preventDefault();\n                try {\n                    await launchViewGrading(rootNode, {\n                        focusOnClose: e.target,\n                    });\n                } catch (error) {\n                    Notification.exception(error);\n                }\n            } else {\n                throw Error('Unable to find a valid gradable item');\n            }\n        }\n    });\n};\n"],"names":["_interopRequireDefault","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","_interopRequireWildcard","_typeof","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","value","arg","input","hint","prim","Symbol","toPrimitive","undefined","res","TypeError","String","Number","_toPrimitive","_toPropertyKey","configurable","writable","_regeneratorRuntime","exports","Op","hasOwn","$Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","type","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","method","_invoke","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","done","methodName","return","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","val","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","thrown","delegateYield","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","Selectors","_repository","_templates","Grader","_notification","_repository2","_ref2","_ref4","templateNames","getContentForUserIdFunction","cmid","experimentalDisplayMode","userid","Repository","getDiscussionByUserID","discussions","map","discussionPostMapper","experimentaldisplaymode","Templates","render","Notification","getUsersForCmidFunction","groupID","onlyActive","_callee","_context","CourseRepository","getUsersFromCourseModuleID","users","findGradableNode","node","closest","gradableItem","discussion","parentMap","Map","posts","parentposts","post","id","userPosts","userposts","readonly","hasreplies","replies","parent","parentid","parentauthorname","author","fullname","launchWholeForumGrading","rootNode","_ref3","_ref3$focusOnClose","focusOnClose","data","gradingPanelFunctions","_args2","_context2","dataset","getGradingPanelFunctions","contextid","gradingComponent","gradingComponentSubtype","gradableItemtype","group","gradeOnlyActiveUsers","launch","getter","setter","groupid","initialUserId","initialuserid","moduleName","courseName","courseUrl","relativeUrl","courseId","sendStudentNotifications","_callee2","_x","launchViewGrading","_ref5","_ref5$focusOnClose","_args3","_context3","view","_callee3","_x2","_exports","registerLaunchListeners","_ref6","document","addEventListener","e","_rootNode","_context4","matches","gradableItems","wholeForum","preventDefault","t0","viewGrade","t1","_callee4","_x3"],"mappings":"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"}